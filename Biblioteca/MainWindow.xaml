<Window x:Class="Biblioteca.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Biblioteca"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">
    <Grid OpacityMask="Black">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <StackPanel VerticalAlignment="Center" Grid.Column="1">
            <Button Content="Libros" Click="Libros_click" Margin="10,10,10,10"/>
            <Button Content="Usuarios" Click="Usuarios_click" Margin="10,10,10,10"/>
            <Button Content="Prestamos y Devoluciones" Click="Prestamos_click" Margin="10,10,10,10"/>
        </StackPanel>

        <!--<StackPanel Grid.Column="2" x:Name="spLibros" IsEnabled="true" Visibility="Visible" Background="White">-->
        <Grid Grid.Column="2" x:Name="spLibros" Visibility="Hidden" Background="White">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <Label Content="Ingrese el nombre del libro" Margin="5,5,5,5" FontFamily="Arial"/>
                <TextBox Text="{Binding Titulo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>

                <Label Content="Ingrese el nombre del Autor" Margin="5,5,5,5" FontFamily="Arial"/>
                <TextBox Text="{Binding Autor, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>

                <Button Content="Agregar Libro" Command="{Binding GuardarCommand}" Margin="5,5,5,5" />

                <Button Content="Eliminar Libro" Command="{Binding EliminarCommand}" Margin="5,5,5,5"/>
            </StackPanel>

            <StackPanel Grid.Column="0">
                <DataGrid 
                    ItemsSource="{Binding ListaLibros}" 
                    SelectedItem="{Binding LibroSeleccionado, Mode=TwoWay}"
                    VerticalAlignment="Top" 
                    x:Name="dgLibros" 
                    AutoGenerateColumns="false">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Título" Binding="{Binding Titulo}" Width="*"/>
                        <DataGridTextColumn Header="Autor" Binding="{Binding Autor}" Width="*"/>
                    </DataGrid.Columns>
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Foreground" Value="Black"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Estado}" Value="True">
                                    <Setter Property="Foreground" Value="Gray"/>
                                    <Setter Property="IsEnabled" Value="False"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                </DataGrid>
            </StackPanel>
        </Grid>

        <!--</StackPanel>-->

        <!--<StackPanel Grid.Column="2" x:Name="spUsuarios" IsEnabled="False" Visibility="Hidden" Background="White">-->
        <Grid Grid.Column="2" x:Name="spUsuarios" Visibility="Hidden" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <DataGrid Grid.Row="1" ItemsSource="{Binding ListaUsuarios}" 
                      SelectedItem="{Binding UsuarioSeleccionado, Mode=TwoWay}"
                      VerticalAlignment="Top" x:Name="dgUsuarios" AutoGenerateColumns="True"/>

            <StackPanel Grid.Column="1" Grid.Row="1">
                <Label Content="Nombre" Margin="5,4,5,4" FontFamily="Arial"/>
                <TextBox Text="{Binding Nombre, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>

                <Label Content="Apellido" Margin="5,5,5,5" FontFamily="Arial"/>
                <TextBox Text="{Binding Apellido, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>

                <Label Content="Telefono" Margin="5,5,5,5" FontFamily="Arial"/>
                <TextBox Text="{Binding Numero, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>

                <Label Content="Email" Margin="5,5,5,5" FontFamily="Arial"/>
                <TextBox Text="{Binding Correo, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5,0,5,0"/>
            </StackPanel>

            <Grid Grid.Row="2" Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Button Content="Agregar / Editar" Command="{Binding GuardarCommand}" Margin="5,5,5,5" Grid.Row="1" />

                <Button Content="Eliminar" Command="{Binding EliminarCommand}" Margin="5,5,5,5" Grid.Row="2" />
            </Grid>
        </Grid>

        <!--</StackPanel>-->

        <!--<StackPanel Grid.Column="2" x:Name="spPrestamos" IsEnabled="True" Visibility="visible" Background="White">-->
        <Grid Grid.Column="2" x:Name="spPrestamos" Visibility="Visible" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <DataGrid Grid.Row="1" 
    ItemsSource="{Binding ListaPrestamosActivos}" 
    SelectedItem="{Binding PrestamoSeleccionado, Mode=TwoWay}"
    x:Name="dgPrestamos" 
    AutoGenerateColumns="False">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Usuario" Binding="{Binding Usuario}" Width="*"/>

                    <DataGridTextColumn Header="Libro" Binding="{Binding Libro.Titulo}" Width="2*"/>

                    <DataGridTextColumn Header="Fecha Préstamo" Binding="{Binding FechaPrestamo, Mode=TwoWay, StringFormat='dd/MM/yyyy'}" Width="*"/>
                    <DataGridTextColumn Header="Fecha Devolución" Binding="{Binding FechaDevolucion,  Mode=TwoWay, StringFormat='dd/MM/yyyy'}" Width="*"/>
                    <DataGridCheckBoxColumn Header="Estado+" Binding="{Binding Estado, Mode=TwoWay}" IsReadOnly="True" Width="Auto"/>
                </DataGrid.Columns>
            </DataGrid>

            <DataGrid Grid.Row="2" ItemsSource="{Binding ListaLibros}" 
              SelectedItem="{Binding LibroSeleccionado, Mode=TwoWay}"
              VerticalAlignment="Top" x:Name="dgLibrosPrestamos" AutoGenerateColumns="False" Margin="5,0,5,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Título" Binding="{Binding Titulo}" Width="2*"/>

                    <DataGridTextColumn Header="Autor" Binding="{Binding Autor}" Width="*"/>

                    <DataGridCheckBoxColumn Header="Estado" 
                                Binding="{Binding Estado, Mode=OneWay}" 
                                IsReadOnly="True" 
                                Width="Auto"/>

                </DataGrid.Columns>


            </DataGrid>

            <StackPanel Grid.Column="1" Grid.Row="1">
                <Label Content="Ingrese la fecha de prestamo" Margin="5,5,5,5"/>
                <DatePicker SelectedDate="{Binding FechaPrestamo, Mode=TwoWay}" Margin="5,5,5,5"/>
                <Label Content="Fecha de devolucion" Margin="5,5,5,5"/>
                <DatePicker SelectedDate="{Binding FechaDevolucion, Mode=TwoWay}" Margin="5,5,5,5"/>
                <Label Content="Nombre Prestamista" Margin="5,5,5,5"/>
                <ComboBox IsEditable="True" ItemsSource="{Binding ListaUsuarios}" 
    SelectedItem="{Binding UsuarioSeleccionado, Mode=TwoWay}" IsDropDownOpen="True" StaysOpenOnEdit="True" Margin="5,5,5,5"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Grid.Row="2" VerticalAlignment="Center">
                <Button Content="Prestar" Command="{Binding PrestarCommand}" Margin="5,5,5,5" />
                <Button Content="Devolver" Command="{Binding DevolverCommand}" Margin="5,5,5,5" />
            </StackPanel>
        </Grid>

        <!--</StackPanel>-->

    </Grid>
</Window>
